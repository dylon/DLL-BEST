(function(a,b){Function.prototype.inherits=function(c){var d=new c;if(d.__proto__===b)d.__proto__=d;d.__super__=c;this.prototype=d;this.prototype.constructor=this;return this};Function.prototype.extend=function(){var c,d,e,f,g,h;c=this.prototype;d=arguments;h=d.length;for(g=0;g<h;++g)if(e=d[g])for(f in e)if(e.hasOwnProperty(f))c[f]=e[f];return this};Function.prototype.namespace=function(c){var d,e,f,g;if(typeof c==="string")c=c.split(".");e=c.length;f=a;for(d=0;d<e;++d){g=c[d];g in f||(f[g]={});f=
f[g]}this.__ns__=f;return this};Function.prototype.cname=function(c){this.__ns__[c]=this;this.__name__=c;return this};Function.prototype.fname=function(c){var d,e;if(typeof c==="string")c=c.split(".");d=c.length;e=c[d-1];this.namespace(c.slice(0,d-2)).cname(e);return this};(function(){}).inherits(Object).fname("DllBest.Base")})(this);(function(){(function(a,b){this.key=a;this.value=b}).inherits(DllBest.Base).fname("DllBest.Node").extend({lChild:null,rChild:null,height:0,lt:null,gt:null,eq:null,assign:function(a,b){this.lChild=a.lChild;this.rChild=a.rChild;this.height=a.height;if(b){this.key=a.key;this.value=a.value;this.eq=a.eq}this.lt=a.lt;this.gt=a.gt;if(this.lt)this.lt.gt=this;if(this.gt)this.gt.lt=this},toString:function(){return"( "+this.key+" )"}})})(window);(function(){(function(a,b){this.N=a;this.compare=b}).inherits(DllBest.Base).fname("DllBest.Tree").extend({compare:null,height:function(){if(this.root)return this.root.height;return 0},biggest:function(){if(this.root)return this.findBiggest(this.root);return null},smallest:function(){if(this.root)return this.findSmallest(this.root);return null},N:null,root:null,elements:0,tryInsert:function(a,b){if(!this.root){this.root=new this.N(a,b);return true}if(!this.find(a)){this.addAsChild(this.root,new this.N(a,
b));this.elements+=1;return true}return false},put:function(a,b){var c=this.find(a);if(c)c.value=b;else this.insert(a,b);return this},insert:function(a,b){var c=new this.N(a,b);if(this.root){this.addAsChild(this.root,c);this.elements+=1}else this.root=c;return this},findBiggest:function(a){for(;a.rChild;)a=a.rChild;return a},findSmallest:function(a){for(;a.lChild;)a=a.lChild;return a},preorder:function a(b,c){if(!b)b=this.root;c||(c=[]);if(!b)return c;c.push(b.value);for(var d=b;d=d.eq;)c.push(d.value);
b.lChild&&a(b.lChild,c);b.rChild&&a(b.rChild,c);return c},inorder:function a(b,c){if(!b)b=this.root;c||(c=[]);if(!b)return c;b.lChild&&a(b.lChild,c);c.push(b.value);for(var d=b;d=d.eq;)c.push(d.value);b.rChild&&a(b.rChild,c);return c},postorder:function a(b,c){if(!b)b=this.root;c||(c=[]);if(!b)return c;b.lChild&&a(b.lChild,c);b.rChild&&a(b.rChild,c);c.push(b.value);for(var d=b;d=d.eq;)c.push(d.value);return c},find:function(a){return this.findInSubtree(this.root,a)},findInSubtree:function a(b,c){if(!b)return null;
var d=this.compare(c,b.key);if(d<0)return a(b.lChild,c);if(d>0)return a(b.rChild,c);return b},remove:function(a){if(a=this.find(a)){this.removeNode(a);return true}return false},getRange:function(a,b){for(var c=[],d=this.root,e,f;d;){f=this.compare(d.key,a);if(f<0)d=d.rChild;else if(f>0){e=d;d=d.lChild}else break}for(d||(d=e);d&&this.compare(d.key,b)<=0;){c.push(d.value);for(e=d;e=e.eq;)c.push(e.value);d=d.gt}return c},dlldump:function(){for(var a=this.smallest(),b=[],c;a;){b.push(a.value);for(c=a;c=
c.eq;)b.push(c.value);a=a.gt}return b},dequeue:function(){var a=this.biggest();if(a){this.removeNode(a);return a.value}return null}})})(window);(function(){(function(a,b){this.__super__(a,b)}).inherits(DllBest.Node).fname("DllBest.Avl.Node").extend({parent:null,isLeaf:function(){return this.height===0},isBranch:function(){var a=!!this.lChild,b=!!this.rChild;return a&&!b||!a&&b},maxChildHeight:function(){var a=this.lChild?this.lChild.height:-1,b=this.rChild?this.rChild.height:-1;return a>b?a:b},balance:function(){return(this.lChild?this.lChild.height:-1)-(this.rChild?this.rChild.height:-1)},isBalanced:function(){var a=this.balance();return a>=
-1&&a<=1},assign:function(a,b){this.__proto__.assign(a,b);this.parent=a.parent;if(this.lChild)this.lChild.parent=this;if(this.rChild)this.rChild.parent=this},toString:function(){return this.key+" ( "+this.height+" )"}})})(window);(function(){(function(a){this.__super__(DllBest.Avl.Node,a)}).inherits(DllBest.Tree).fname("DllBest.Avl.Tree").extend({RRC:function(a,b,c,d){b=a.rChild;a.rChild=b.lChild;if(a.rChild)a.rChild.parent=a;b.lChild=a;a.parent=b;if(d){if(d.rChild===a)d.rChild=b;else d.lChild=b;b.parent=d}else{this.root=b;this.root.parent=null}this.recomputeHeights(a);this.recomputeHeights(b.parent)},RLC:function(a,b,c,d){b=a.rChild;c=b.lChild;b.lChild=c.rChild;if(b.lChild)b.lChild.parent=b;a.rChild=c.lChild;if(a.rChild)a.rChild.parent=
a;c.rChild=b;b.parent=c;c.lChild=a;a.parent=c;if(d){if(d.rChild===a)d.rChild=c;else d.lChild=c;c.parent=d}else{this.root=c;this.root.parent=null}this.recomputeHeights(a);this.recomputeHeights(b)},LLC:function(a,b,c,d){b=a.lChild;a.lChild=b.rChild;if(a.lChild)a.lChild.parent=a;b.rChild=a;a.parent=b;if(d){if(d.rChild===a)d.rChild=b;else d.lChild=b;b.parent=d}else{this.root=b;this.root.parent=null}this.recomputeHeights(a);this.recomputeHeights(b.parent)},LRC:function(a,b,c,d){b=a.lChild;c=b.rChild;a.lChild=
c.rChild;if(a.lChild)a.lChild.parent=a;b.rChild=c.lChild;if(b.rChild)b.rChild.parent=b;c.lChild=b;b.parent=c;c.rChild=a;a.parent=c;if(d){if(d.rChild===a)d.rChild=c;else d.lChild=c;c.parent=d}else{this.root=c;this.root.parent=null}this.recomputeHeights(a);this.recomputeHeights(b)},rebalance:function(a){var b=a.balance(),c=a.parent;if(b<=-2)a.rChild.balance()<=0?this.RRC(a,void 0,void 0,c):this.RLC(a,void 0,void 0,c);else if(b>=2)a.lChild.balance()>=0?this.LLC(a,void 0,void 0,c):this.LRC(a,void 0,void 0,
c)},recomputeHeights:function(a){for(var b=true;a&&b;){b=a.height;a.height=a.rChild||a.lChild?a.maxChildHeight()+1:0;b=a.height!==b;a=a.parent}},addAsChild:function(a,b){var c=null,d;d=this.compare(b.key,a.key);if(d<0)c=this.addLeftChild(a,b);else if(d>0)c=this.addRightChild(a,b);else this.addEqualChild(a,b);c&&this.rebalance(c)},addLeftChild:function(a,b){b.gt=a;var c=null,d;if(a.lChild)this.addAsChild(a.lChild,b);else{a.lChild=b;b.parent=a;if(a.lt)a.lt.gt=b;a.lt=b;if(a.height===0)for(d=a;d;){d.height=
d.maxChildHeight()+1;if(!d.isBalanced()){c=d;break}d=d.parent}}return c},addRightChild:function(a,b){b.lt=a;var c=null,d;if(a.rChild)this.addAsChild(a.rChild,b);else{a.rChild=b;b.parent=a;if(a.gt)a.gt.lt=b;a.gt=b;if(a.height===0)for(d=a;d;){d.height=d.maxChildHeight()+1;if(!d.isBalanced()){c=d;break}d=d.parent}}return c},addEqualChild:function(a,b){b.eq=a.eq;a.eq=b;b.lt=null;b.gt=null},removeNode:function(a){this.elements-=1;if(a.eq)a.eq.assign(a);else{if(a.lt)a.lt.gt=a.gt;if(a.gt)a.gt.lt=a.lt;if(a.isLeaf())this.removeLeaf(a);
else a.isBranch()?this.removeBranch(a):this.swapAndRemove(a)}},removeLeaf:function(a){var b=a.parent;if(b){if(b.lChild===a)b.lChild=null;else b.rChild=null;this.recomputeHeights(b);a=b;do a.isBalanced()||this.rebalance(a);while(a=a.parent)}else this.root=null},removeBranch:function(a){var b=a.parent;if(b){if(b.lChild)b.lChild=a.rChild||a.lChild;else b.rChild=a.rChild||a.lChild;if(a.lChild)a.lChild.parent=b;else a.rChild.parent=b;this.recomputeHeights(b);a=b;do a.isBalanced()||this.rebalance(a);while(a=
a.parent)}},swapAndRemove:function(a){var b=this.findSmallest(a.rChild);this.swapNodes(a,b);a.height===0?this.removeLeaf(a):this.removeBranch(a)},swapNodes:function(a,b){var c=a.parent,d=a.lChild,e=a.rChild,f=b.parent,g=b.lChild,h=b.rChild,i;i=a.height;a.height=b.height;b.height=i;if(c){if(c.lChild===a)c.lChild=b;else c.rChild=b;b.parent=c}else{this.root=b;b.parent=null}b.lChild=d;d.parent=b;a.lChild=g;if(a.rChild=h)h.parent=a;else if(f!==a){b.rChild=e;e.parent=b;f.lChild=a;a.parent=f}else{b.rChild=
a;a.parent=b}}})})(window);
